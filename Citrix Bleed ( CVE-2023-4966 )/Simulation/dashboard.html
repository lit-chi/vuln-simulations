<!DOCTYPE html>
<html>
    <head>
        <title>
            Dashboard
        </title>
        <link href="main.css" rel="stylesheet" >
    </head>
    <body onload="load_func()">
        <h1 id="1"></h1>
        <hr>
        <h2 id="2"> </h2>
        <script src="./config.js"></script>
        <script>
            
            function getCookie(name) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${name}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
                return null;
            }

            function load_func(){
                const ip = BACKEND_IP; //ip of the machine where the backend is gonna run
                cookie = getCookie('session_id');
                if(cookie){
                    fetch(`http://${ip}:3000/username` , {
                        method: "GET",
                        headers:{"session_id":cookie}
                    })
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById("1").innerHTML = `${data.username}`
                        document.getElementById("2").innerHTML ="SUCCESSFUL LOGIN";
                    });

                }
                else{
                    document.getElementById("2").innerHTML ="UNAUTHORIZED";
                }
            }
        </script>
    </body>
</html>