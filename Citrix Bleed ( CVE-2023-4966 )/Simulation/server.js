const express = require('express');
const app = express();
app.use(express.json());

sensitive_data = 'session-id=80ac1101c9228c423bc9783'

var memory = new Array(30).fill('_');

for(let i=0;i<sensitive_data.length;i++){
    memory[30+i] = sensitive_data[i];
}

function vuln_function(inp,buffer){
    var len = inp.length;
    if(len>30){
        len=30;
    }
    for(let i=0;i<len;i++){
        buffer[i] = inp[i]
    }
    return inp.length; 
}

app.get('/something', (req,res) => {
    const token = req.headers.auth;

    len = vuln_function(token,memory)
    console.log(memory.slice(0,len).join('')    )
    res.send(memory.slice(0,len).join(''));
})

app.listen(3000);